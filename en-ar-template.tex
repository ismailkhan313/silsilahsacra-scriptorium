% !TEX program = xelatex
%
% --- Updated with new layout and styled rules ---

\documentclass[12pt, letterpaper]{article}

%--------------------------------------------------
% Packages for Layout, Spacing, and Headers
%--------------------------------------------------

\usepackage[margin=1in]{geometry}
\usepackage{parskip}
\usepackage{fancyhdr}
\usepackage{enumitem}
\usepackage{hyperref}

%--------------------------------------------------
% Font and Language Setup
%--------------------------------------------------

\usepackage{fontspec}
\usepackage{polyglossia}

\setmainlanguage{english}
\setotherlanguage{arabic}

\setmainfont{Libertinus Serif}

% This block correctly defines the bold font for Arabic, fixing the warnings.
\newfontfamily\arabicfont[
  Script=Arabic,
  Scale=1,
  UprightFont = {ScheherazadeNew-Regular},
  BoldFont = {ScheherazadeNew-Bold}
]{Scheherazade New}
\newfontfamily\arabicfonttt[
  Script=Arabic,
  Scale=1,
  UprightFont = {ScheherazadeNew-Regular},
  BoldFont = {ScheherazadeNew-Bold}
]{Scheherazade New}


%--------------------------------------------------
% Custom Commands and Settings
%--------------------------------------------------

% The date value is captured from the script.
\newcommand{\docdatevalue}{$created$}
% If the date value is empty, default to the current date. \ifstrempty requires the etoolbox package (loaded by parskip).
\newcommand{\docdate}{\ifstrempty{\docdatevalue}{\today}{\docdatevalue}}

\newcommand{\arabicbrand}{\textarabic{مكتبة السلسلة المقدسة}}

\pagestyle{fancy}
\fancyhf{}

% Remove old rule definitions and create a new thicker, styled double rule.
\renewcommand{\headrulewidth}{0pt} % Set to 0 so it doesn't interfere with the custom rule
\renewcommand{\footrulewidth}{0pt} % Set to 0 so it doesn't interfere with the custom rule
\renewcommand{\headrule}{\vbox{\hrule width\headwidth height 1pt \kern 1.5pt \hrule width\headwidth height 0.4pt}}
\renewcommand{\footrule}{\vbox{\hrule width\headwidth height 0.4pt \kern 1.5pt \hrule width\headwidth height 1pt}}

% Header setup
\fancyhead[L]{\small \begin{tabular}{@{}l@{}}Silsilah Sacra Scriptorium \\ \arabicbrand\end{tabular}}
\fancyhead[R]{\small \docdate}

% Footer setup with author name above the URL
\lfoot{\small\begin{tabular}{@{}l@{}}Ismail Al-Faisal \\ \url{https://ismailkhan.xyz/}\end{tabular}}
\cfoot{\small \thepage}

\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}

\setlist[itemize]{itemsep=5pt}
\setlist[enumerate]{itemsep=5pt}


%--------------------------------------------------
% Pandoc Metadata and Custom Title Format
%--------------------------------------------------

\title{$title$}
% Author and Date are in the header/footer.

% --- MODIFIED SECTION ---
% Redefine the \maketitle command for a custom layout with academic-style spacing.
\makeatletter
\def\@maketitle{%
  \begin{center}
  \setlength{\parskip}{0pt}
  
  % --- Space ABOVE the title ---
  % This adds vertical space to push the title down from the header rule.
  % The '*' ensures space is added even at the very top of a page.
  % Adjust '2cm' to a value you like (e.g., 1.5in, 8em).
  \vspace*{2cm}

  % --- The Title ---
  {\Large\bfseries \@title\par}
  
  % --- Space AFTER the title ---
  % This adds space between the title and the first paragraph of the body.
  % Adjust '1.5cm' to increase or decrease the gap.
  \vspace{1.5cm}

  \end{center}
}
\makeatother
% --- END MODIFIED SECTION ---


%--------------------------------------------------
% Document Start
%--------------------------------------------------

\begin{document}

\maketitle
\thispagestyle{fancy}

$body$

\end{document}