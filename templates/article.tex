% !TEX program = lualatex
\documentclass[12pt, letterpaper, twoside]{article}

%----------------------------------------------------------------------------------------
%   REQUIRED PACKAGES AND GLOBAL CONFIGURATIONS
%----------------------------------------------------------------------------------------
\usepackage{fontspec}
\usepackage{geometry}
\usepackage{polyglossia}
\usepackage{fancyhdr}
\usepackage{csquotes}
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage[colorlinks=true, linkcolor=black, citecolor=black, urlcolor=blue]{hyperref}

% --- PANDOC COMPATIBILITY FIX ---
% Pandoc generates \tightlist for lists without spaces between items.
% This defines the command to prevent a LaTeX error.
\providecommand{\tightlist}{}

%----------------------------------------------------------------------------------------
%   PAGE LAYOUT
%----------------------------------------------------------------------------------------
\geometry{top=1in, bottom=1in, left=1.25in, right=1in, headheight=14.5pt, headsep=25pt, footskip=30pt}

%----------------------------------------------------------------------------------------
%   FONT CONFIGURATION
%----------------------------------------------------------------------------------------
\setmainfont{Libertinus Serif}
\usepackage{libertinus-math} % Use a matching, scalable math font
\newfontfamily\arabicfont[Script=Arabic]{Scheherazade New}
\newfontfamily\arabicfonttt{Amiri}[Script=Arabic]

%----------------------------------------------------------------------------------------
%   BILINGUAL SETUP (WITH DEFAULTS)
%----------------------------------------------------------------------------------------
$if(lang)$
\setmainlanguage{$lang$}
$else$
\setmainlanguage{english}
$endif$

$if(otherlangs)$
\setotherlanguage{$otherlangs$}
$endif$

\newcommand{\textarab}[1]{\textarabic{#1}}

%----------------------------------------------------------------------------------------
%   BIBLIOGRAPHY SETUP
%----------------------------------------------------------------------------------------
$if(biblatex)$
\usepackage[$if(biblio-style)$style=$biblio-style$,$endif$backend=biber]{biblatex}
\addbibresource{$bibliography$}
$endif$

%----------------------------------------------------------------------------------------
%   HEADER AND FOOTER
%----------------------------------------------------------------------------------------
\pagestyle{fancy}
\fancyhf{}
\renewcommand{\headrulewidth}{0.4pt}
\renewcommand{\footrulewidth}{0.4pt}
\fancyhead[LE,RO]{\textit{$author$}}
\fancyhead[RE,LO]{\textit{$title$}}
\fancyfoot[C]{\thepage}

\fancypagestyle{plain}{
  \fancyhf{}
  \renewcommand{\headrulewidth}{0pt}
  \fancyfoot[C]{\thepage}
}

%----------------------------------------------------------------------------------------
%   METADATA AND TITLE BLOCK
%----------------------------------------------------------------------------------------
\title{\vspace{-2cm}\fontsize{18}{22}\selectfont\textbf{$title$}}
\author{$author$}
$if(date)$
\date{$date$}
$endif$

%----------------------------------------------------------------------------------------
%   HEADING AND SPACING CUSTOMIZATION
%----------------------------------------------------------------------------------------
\usepackage{titlesec}
\titleformat{\section}{\Large\bfseries}{\thesection}{1em}{}
\titleformat{\subsection}{\large\bfseries}{\thesubsection}{1em}{}
\titleformat{\subsubsection}{\bfseries}{\thesubsubsection}{1em}{}
\titlespacing*{\section}{0pt}{3.5ex plus 1ex minus .2ex}{2.3ex plus .2ex}
\titlespacing*{\subsection}{0pt}{3.25ex plus 1ex minus .2ex}{1.5ex plus .2ex}

%----------------------------------------------------------------------------------------
%   DOCUMENT START
%----------------------------------------------------------------------------------------
\begin{document}

\maketitle
\thispagestyle{plain}

$if(abstract)$
\begin{abstract}
\noindent $abstract$
\end{abstract}
\vspace{1cm}
$endif$

$if(toc)$
\tableofcontents
\newpage
$endif$

$body$

$if(biblatex)$
\printbibliography
$endif$

\end{document}